go through lines 511 onwards, needs dumbing down